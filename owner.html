<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم المالك - منصة تعليم البرمجة</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="cosmic-background">
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="planet planet-earth"></div>
        <div class="planet planet-moon"></div>
        <div class="sun"></div>
    </div>

    <div class="page-container">
        <div class="cosmic-logo">
            <h1>لوحة تحكم المالك</h1>
            <div class="subtitle">إدارة حسابات المنصة</div>
        </div>

        <div class="glass-form">
            <h3 style="text-align: center; color: var(--electric-blue); margin-bottom: 30px;">إنشاء حساب جديد</h3>
            
            <div class="input-group">
                <select class="glass-input" id="governorate">
                    <option value="">اختر المحافظة</option>
                </select>
            </div>

            <div class="input-group">
                <select class="glass-input" id="city" disabled>
                    <option value="">اختر المدينة</option>
                </select>
            </div>

            <div class="input-group">
                <select class="glass-input" id="userType">
                    <option value="">اختر النوع</option>
                    <option value="1">مستر</option>
                    <option value="2">طالب</option>
                </select>
            </div>

            <div class="input-group">
                <select class="glass-input" id="school" disabled>
                    <option value="">اختر المدرسة</option>
                </select>
            </div>

            <div class="input-group">
                <input type="text" class="glass-input" id="studentId" placeholder="معرف الطالب (3 أرقام)" maxlength="3" disabled>
            </div>

            <div class="input-group">
                <input type="text" class="glass-input" id="fullName" placeholder="الاسم الكامل" disabled>
            </div>

            <div class="input-group">
                <input type="password" class="glass-input" id="password" placeholder="كلمة المرور" disabled>
            </div>

            <div class="user-preview" id="userPreview" style="display: none;">
                <h4>معاينة الحساب:</h4>
                <div id="previewContent"></div>
            </div>

            <button class="ghost-button full-width" id="createAccount" disabled>
                إنشاء الحساب
            </button>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <a href="login.html" style="color: var(--electric-blue); text-decoration: none;">
                العودة لتسجيل الدخول
            </a>
        </div>
    </div>

    <script>
        // بيانات المحافظات
        const governorates = [
            { code: '02', name: 'القاهرة' },
            { code: '11', name: 'الإسكندرية' },
            { code: '15', name: 'الجيزة' },
            { code: '22', name: 'المنوفية' },
            { code: '33', name: 'أسوان' }
        ];

        // بيانات النظام
        const systemData = {
            city: { code: '249', name: 'عين شمس' },
            school: { code: '23', name: 'نهضة عين شمس' }
        };

        // عناصر DOM
        const governorateSelect = document.getElementById('governorate');
        const citySelect = document.getElementById('city');
        const userTypeSelect = document.getElementById('userType');
        const schoolSelect = document.getElementById('school');
        const studentIdInput = document.getElementById('studentId');
        const fullNameInput = document.getElementById('fullName');
        const passwordInput = document.getElementById('password');
        const createAccountBtn = document.getElementById('createAccount');
        const userPreview = document.getElementById('userPreview');
        const previewContent = document.getElementById('previewContent');

        // تخزين الحسابات
        let users = JSON.parse(localStorage.getItem('platformUsers')) || [];

        // تهيئة المحافظات
        function initGovernorates() {
            governorates.forEach(gov => {
                const option = document.createElement('option');
                option.value = gov.code;
                option.textContent = `${gov.code} - ${gov.name}`;
                governorateSelect.appendChild(option);
            });
        }

        // أحداث التغيير
        governorateSelect.addEventListener('change', function() {
            if (this.value) {
                citySelect.disabled = false;
                citySelect.innerHTML = '<option value="">اختر المدينة</option>';
                const option = document.createElement('option');
                option.value = systemData.city.code;
                option.textContent = `${systemData.city.code} - ${systemData.city.name}`;
                citySelect.appendChild(option);
            } else {
                citySelect.disabled = true;
                citySelect.value = '';
            }
            updateCreateButton();
        });

        citySelect.addEventListener('change', function() {
            if (this.value) {
                userTypeSelect.disabled = false;
            } else {
                userTypeSelect.disabled = true;
                userTypeSelect.value = '';
            }
            updateCreateButton();
        });

        userTypeSelect.addEventListener('change', function() {
            if (this.value) {
                schoolSelect.disabled = false;
                schoolSelect.innerHTML = '<option value="">اختر المدرسة</option>';
                const option = document.createElement('option');
                option.value = systemData.school.code;
                option.textContent = `${systemData.school.code} - ${systemData.school.name}`;
                schoolSelect.appendChild(option);
            } else {
                schoolSelect.disabled = true;
                schoolSelect.value = '';
            }
            updateCreateButton();
        });

        schoolSelect.addEventListener('change', function() {
            if (this.value) {
                studentIdInput.disabled = false;
                fullNameInput.disabled = false;
                passwordInput.disabled = false;
            } else {
                studentIdInput.disabled = true;
                fullNameInput.disabled = true;
                passwordInput.disabled = true;
            }
            updateCreateButton();
        });

        // تحديث معاينة الحساب
        function updateUserPreview() {
            const gov = governorateSelect.value;
            const city = citySelect.value;
            const userType = userTypeSelect.value;
            const school = schoolSelect.value;
            const studentId = studentIdInput.value;
            const fullName = fullNameInput.value;

            if (gov && city && userType && school && studentId && fullName) {
                const userId = gov + city + userType + school + studentId;
                previewContent.innerHTML = `
                    <div><strong>المعرف الكامل:</strong> ${userId}</div>
                    <div><strong>الاسم:</strong> ${fullName}</div>
                    <div><strong>النوع:</strong> ${userType === '1' ? 'مستر' : 'طالب'}</div>
                    <div><strong>المدرسة:</strong> ${systemData.school.name}</div>
                `;
                userPreview.style.display = 'block';
            } else {
                userPreview.style.display = 'none';
            }
        }

        // تحديث زر الإنشاء
        function updateCreateButton() {
            const isFormValid = 
                governorateSelect.value && 
                citySelect.value && 
                userTypeSelect.value && 
                schoolSelect.value && 
                studentIdInput.value && 
                fullNameInput.value && 
                passwordInput.value;

            createAccountBtn.disabled = !isFormValid;
        }

        // إضافة مستمعات للأحداث
        studentIdInput.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
            updateUserPreview();
            updateCreateButton();
        });

        fullNameInput.addEventListener('input', function() {
            updateUserPreview();
            updateCreateButton();
        });

        passwordInput.addEventListener('input', updateCreateButton);

        // إنشاء الحساب
        createAccountBtn.addEventListener('click', function() {
            const userId = governorateSelect.value + citySelect.value + 
                          userTypeSelect.value + schoolSelect.value + 
                          studentIdInput.value;

            const userData = {
                id: userId,
                password: passwordInput.value,
                fullName: fullNameInput.value,
                userType: userTypeSelect.value,
                governorate: governorateSelect.value,
                city: citySelect.value,
                school: schoolSelect.value,
                studentId: studentIdInput.value
            };

            // التحقق من عدم وجود معرف مكرر
            if (users.find(user => user.id === userId)) {
                alert('هذا المعرف موجود مسبقاً!');
                return;
            }

            users.push(userData);
            localStorage.setItem('platformUsers', JSON.stringify(users));

            alert(`تم إنشاء الحساب بنجاح!\nالمعرف: ${userId}\nكلمة المرور: ${passwordInput.value}`);

            // إعادة تعيين النموذج
            resetForm();
        });

        function resetForm() {
            governorateSelect.value = '';
            citySelect.value = '';
            userTypeSelect.value = '';
            schoolSelect.value = '';
            studentIdInput.value = '';
            fullNameInput.value = '';
            passwordInput.value = '';
            
            citySelect.disabled = true;
            userTypeSelect.disabled = true;
            schoolSelect.disabled = true;
            studentIdInput.disabled = true;
            fullNameInput.disabled = true;
            passwordInput.disabled = true;
            
            userPreview.style.display = 'none';
            createAccountBtn.disabled = true;
        }

        // التهيئة
        initGovernorates();
    </script>
</body>
</html>
